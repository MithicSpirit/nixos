\RequirePackage[l2tabu,orthodox]{nag}

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{math}[Personal package for mathematics typesetting]

\RequirePackage{iftex}

\RequirePackage{amsmath}
\RequirePackage{amsthm}
\RequirePackage{amssymb}

\RequirePackage{tikz}
\RequirePackage{tikz-cd}
\RequirePackage{pgfplots}
\RequirePackage{graphicx}
\RequirePackage{xcolor}
\RequirePackage{caption}
\RequirePackage[shortlabels]{enumitem}

\RequirePackage{mathtools}
\RequirePackage{thmtools}
\ifluatex\RequirePackage{lualatex-math}\fi
\RequirePackage{mathrsfs}
\RequirePackage{stmaryrd}
\RequirePackage[nointegrals]{wasysym}
\RequirePackage{esint}

\RequirePackage{xfrac}
\RequirePackage{siunitx}
\RequirePackage{interval}
\RequirePackage{mleftright}
\RequirePackage{derivative}
\RequirePackage[version=4]{mhchem}

\RequirePackage{hyperref}
\RequirePackage[nameinlink]{cleveref}

\pgfplotsset{compat=newest, tick scale binop=\times}
\usepgfplotslibrary{colormaps}
\usetikzlibrary{3d}
\usetikzlibrary{perspective}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{positioning}

\sisetup{
  retain-explicit-decimal-marker=true,
  retain-zero-uncertainty,
  uncertainty-mode=separate,
  list-final-separator={,\text{ and }},
  table-alignment-mode=format,
}
\DeclareSIUnit\clight{\text{\ensuremath{c}}}
\DeclareSIUnit\boltzmann{\text{\ensuremath{k_{\text{B}}}}}

\intervalconfig{soft open fences}

\mleftright{}

\NewDifferential{\vdif}{\nabla}
\newcommand{\dv}{\odv}
\newcommand{\Dv}{\mdv}
\newcommand{\dev}{\fdv}
\newcommand{\Dev}{\adv}
% \pdv, \jdv already included
\newcommand{\dd}{\odif}
\newcommand{\pdd}{\pdif}
\newcommand{\Dd}{\mdif}
\newcommand{\dde}{\fdif}
\newcommand{\Dde}{\adif}
\newcommand{\ndd}{\vdif}

\theoremstyle{definition}

\newtheorem{theorem}{Theorem}[section]
\newtheorem*{theorem*}{Theorem}
\crefname{theorem}{Theorem}{Theorems}
\Crefname{theorem}{Theorem}{Theorems}

\newcommand{\crefnewtheorem}[3]{%
  \newtheorem{#1}[theorem]{#2}%
  \newtheorem*{#1*}{#2}%
  \crefname{#1}{#2}{#3}
  \Crefname{#1}{#2}{#3}}

\crefnewtheorem{corollary}{Corollary}{Corollaries}
\crefnewtheorem{lemma}{Lemma}{Lemmata}
\crefnewtheorem{definition}{Definition}{Definitions}
\crefnewtheorem{proposition}{Proposition}{Propositions}
\crefnewtheorem{law}{Law}{Laws}
\crefnewtheorem{conjecture}{Conjecture}{Conjectures}
\crefnewtheorem{example}{Example}{Examples}

\newtheorem{axiom}{Axiom}
\newtheorem*{axiom*}{Axiom}
\crefname{axiom}{Axiom}{Axioms}
\Crefname{axiom}{Axiom}{Axioms}

\newenvironment{proof*}[1][\proofname]%
{\begin{proof}[#1]\renewcommand*{\qed}{}}%
{\end{proof}}

\newcommand{\foreign}{\emph}
\renewcommand{\foreignlanguage}[1]{\foreign}
\newcommand{\etc}{\foreign{etc.}}
\newcommand{\ie}{\foreign{i.e.\@}}
\newcommand{\eg}{\foreign{e.g.\@}}
\newcommand{\nb}{\foreign{N.B.\@}}
\newcommand{\cf}{\foreign{cf.\@}}

\newcommand{\p}[1]{\mathrlap{\,\text{#1}}}
\newcommand{\cat}[2][]{\ensuremath{\operatorname{\mathnormal{#1}\mathbf{#2}}}}
\newcommand{\operatorsf}[1]{\operatorname{\mathsf{#1}}}

\newcommand{\trans}{^{\mathsf{T}}}
\newcommand{\compl}{^{\complement}}
\newcommand{\op}{^{\operatorname{op}}}

\DeclareMathOperator{\ob}{ob}
\DeclareMathOperator{\mor}{mor}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\cod}{cod}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\img}{img}
\DeclareMathOperator{\coimg}{coimg}
\DeclareMathOperator{\coker}{coker}
\DeclareMathOperator{\inv}{inv}

\DeclareMathOperator{\erf}{erf}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\csch}{csch}

\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}

\DeclareMathOperator{\Span}{Span}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\nullity}{null}
\DeclareMathOperator{\GL}{GL}
\DeclareMathOperator{\proj}{proj}
\DeclareMathOperator{\rej}{rej}
\DeclareMathOperator{\refl}{refl}

\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\let\morph\xrightarrow
\let\lmorph\xleftarrow

\newcommand{\nodisplaytop}{\strut\nopagebreak\vspace{-\baselineskip-\abovedisplayskip}}
\newcommand{\displaymerge}{\strut\nopagebreak\vspace{-\belowdisplayskip-\baselineskip-\abovedisplayskip}}

\newcommand{\bra@nostar}[2][]{
  \ifx#1\empty \langle #2 \rvert % chktex 1
  \else \csname #1l \endcsname\langle #2 \csname #1r \endcsname\rvert \fi} % chktex 1
\newcommand{\bra@star}[1]{\left\langle #1 \right\rvert} % chktex 1
\newcommand{\bra}{\@ifstar{\bra@star}{\bra@nostar}}

\newcommand{\ket@nostar}[2][]{
  \ifx#1\empty \lvert #2 \rangle % chktex 1
  \else \csname #1l \endcsname\lvert #2 \csname #1r \endcsname\rangle \fi} % chktex 1
\newcommand{\ket@star}[1]{\left\lvert #1 \right\rangle} % chktex 1
\newcommand{\ket}{\@ifstar{\ket@star}{\ket@nostar}}

\ifluatex
  \def\@middlemid{\Umiddle class 3 \vert} % chktex 1
\else
  \def\@middlemid{\mathrel{}\middle\vert\mathrel{}}
\fi

\newcommand{\braket@nostar}[3][]{
  \ifx#1\empty \langle #2 \mid #3 \rangle % chktex 1
  \else \csname #1l \endcsname\langle #2 \csname #1m \endcsname\vert #3 %chktex 1
  \csname #1r \endcsname\rangle \fi} % chktex 1
\newcommand{\braket@star}[2]{\left\langle #1 \@middlemid #2 \right\rangle} % chktex 1
\newcommand{\braket}{\@ifstar{\braket@star}{\braket@nostar}}


\let\phantom@nostar\phantom  % chktex 1
\newcommand{\phantom@star}[1]{\phantom@nostar{{}#1{}}}
\renewcommand{\phantom}{\@ifstar{\phantom@star}{\phantom@nostar}}
\newcommand{\phantomeq}{\phantom*{=}}

\let\qedhere@nostar\qedhere
\renewcommand{\qedhere}{\@ifstar{\tag*{\qedhere@nostar}}{\qedhere@nostar}}

\let\sqrt@nostar\sqrt  % chktex 1
\newcommand{\sqrt@star}[1]{\sqrt@nostar{\textstyle{#1}}}
\renewcommand{\sqrt}{\@ifstar{\sqrt@star}{\sqrt@nostar}}

\newlength\@xwidth\settowidth\@xwidth{\(x\)}
\newcommand{\slot}{\mathmakebox[\@xwidth]{\cdot}}

\newlength\nphant@wd
\newcommand{\nphant@do}[1]{\settowidth{\nphant@wd}{#1}\hspace*{-\nphant@wd}}
\newcommand{\nphant@math}[2]{\nphant@do{$\m@th#1#2$}}
\DeclareRobustCommand{\nphantom}[1]{%
  \ifmmode  % chktex 1
    \mathpalette\nphant@math{#1}%
  \else
    \nphant@do{#1}%
  \fi
}

\newenvironment{smat}{\smallmatrix}{\endsmallmatrix}
\newenvironment{psmat}{\psmallmatrix}{\endpsmallmatrix}
\newenvironment{bsmat}{\bsmallmatrix}{\endbsmallmatrix}
\newenvironment{Bsmat}{\Bsmallmatrix}{\endBsmallmatrix}
\newenvironment{vsmat}{\vsmallmatrix}{\endvsmallmatrix}
\newenvironment{Vsmat}{\Vsmallmatrix}{\endVsmallmatrix}

\renewcommand{\implies}{\@ifstar{\Rightarrow}{\Longrightarrow}}
\renewcommand{\impliedby}{\@ifstar{\Leftarrow}{\Longleftarrow}}
\renewcommand{\iff}{\@ifstar{\Leftrightarrow}{\Longleftrightarrow}}

\newcommand{\registered}{\textsuperscript{\textregistered}}
